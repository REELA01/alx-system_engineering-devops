#!/usr/bin/env bash
# Path to the Gunicorn PID file
GUNICORN_PID_FILE="/path/to/gunicorn.pid"

# Check if the Gunicorn PID file exists
if [ ! -f "$GUNICORN_PID_FILE" ]; then
  echo "Gunicorn PID file does not exist: $GUNICORN_PID_FILE"
  exit 1
fi

# Get the PID of the Gunicorn master process
GUNICORN_PID=$(cat "$GUNICORN_PID_FILE")

# Check if the PID is valid (i.e., the process is running)
if ps -p $GUNICORN_PID > /dev/null; then
  echo "Sending HUP signal to Gunicorn (PID: $GUNICORN_PID) for graceful reload"
  kill -HUP $GUNICORN_PID
else
  echo "No Gunicorn process found with PID: $GUNICORN_PID"
  exit 1
fi

echo "Graceful reload signal sent to Gunicorn. Check the logs to ensure the process restarted correctly."

